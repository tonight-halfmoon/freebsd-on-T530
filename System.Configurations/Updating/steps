


# Commands related to maintain FreeBSD and system packages and apps

## Update & Install packages

```
# portsnap fetch update
# portsnap fetch extract
# portmaster -ady --no-confirm
;; **
# portmaster -aD
# pkg check -Ba
# portmaster -a

```

** When something goes wrong with a package then try the following

```
# portmaster -w -r package-name
```
In case the command with optin -r does not work try without it, as follows:

```
# portmaster -w package-name
```

Find out the reason of failure. If that is because of packages conflict, the deinstall the other package which the cause.
Sometimes, it may even need to deinstall the package first. Then, try again.

Then, to continue the full update. Try with the following

```
# portmaster -afR --no-confirm
```


```
# pkg update
# pkg upgrade

```

## Reference:
0. https://www.freebsd.org/doc/handbook/ports-using.html
0. https://forums.freebsd.org/threads/not-able-to-build-gnupg.52242/


```
#cd /usr/ports/sysutils/lsof
#make install
```

## Clean up 
```
# portmaster --clean-distfiles -y
# portsclean -C
# portsclean -DD
--> to delete many packages at once with regX
# pkg delete -R '*proto-*'a

```

## Upgrade certain package 

```
# Upgrade a package
# portupgrade -R firefox
```


## Updating FreeBSD 
##  EoF of FreeBSD release 11.1 


No updates needed to update system to 11.1-RELEASE-p15.

WARNING: FreeBSD 11.1-RELEASE-p15 HAS PASSED ITS END-OF-LIFE DATE.


Threfore, the system is upgraded to release 11.2 as follows

```
# freebsd-update fetch
```

Failed since EoL has expired on release 11.1. Then, I did the following


```
 # freebsd-update upgrade -r 11.2

 # freebsd-update install
```

Installing updates...
Kernel updates have been installed.  Please reboot and run
"/usr/sbin/freebsd-update install" again to finish installing updates.


## Uninstall/Deinstall packages

1. Method 1
```
# pkg_deinstall name

2. Method 2
# /usr/ports/name make deinstall
```

## Fix broken apps when they depend on packages has been removed
```
# pkg update -f

# pkg check -a -d
```

## Autoremove left-over packages
```
# pkg autoremove
```


## Fix update 

```
pkg-static upgrade -f
```

```
# portmast -afG
```
```
# freebsd-update fetch
```

```
# freebsd-update install
```

# References

0. FreeBSD Handbook Section "Freebsdupdate-portsbuild" in "updating-upgrading-freebsdupdate"
